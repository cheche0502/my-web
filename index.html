<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤šç”¨æˆ·å­¦ä¹ ç¬”è®°ç®¡ç†ç³»ç»Ÿ - å¢å¼ºç‰ˆ</title>
    <style>
        :root {
            --primary-color: #4a6fa5;
            --secondary-color: #6b8cbc;
            --accent-color: #ff7e5f;
            --light-color: #f8f9fa;
            --dark-color: #343a40;
            --success-color: #28a745;
            --info-color: #17a2b8;
            --warning-color: #ffc107;
            --shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            --transition: all 0.3s ease;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f0f2f5;
            color: var(--dark-color);
            line-height: 1.6;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            text-align: center;
            padding: 30px 0;
            background: linear-gradient(135deg, var(--primary-color), var(--secondary-color));
            color: white;
            border-radius: 10px;
            margin-bottom: 30px;
            box-shadow: var(--shadow);
        }
        
        h1 {
            font-size: 2.5rem;
            margin-bottom: 10px;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .tab-navigation {
            display: flex;
            background: white;
            border-radius: 10px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            overflow: hidden;
        }
        
        .tab-btn {
            flex: 1;
            padding: 15px;
            text-align: center;
            background: none;
            border: none;
            cursor: pointer;
            font-size: 1rem;
            font-weight: 600;
            transition: var(--transition);
            color: var(--dark-color);
        }
        
        .tab-btn.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .main-content {
            display: flex;
            gap: 30px;
            margin-bottom: 30px;
        }
        
        @media (max-width: 768px) {
            .main-content {
                flex-direction: column;
            }
        }
        
        .upload-section {
            flex: 1;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        
        .notes-section {
            flex: 2;
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
        }
        
        .user-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .social-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .recommendation-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .efficiency-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 20px;
            color: var(--primary-color);
            border-bottom: 2px solid var(--light-color);
            padding-bottom: 10px;
        }
        
        .upload-area {
            border: 2px dashed var(--secondary-color);
            border-radius: 8px;
            padding: 40px 20px;
            text-align: center;
            cursor: pointer;
            transition: var(--transition);
            margin-bottom: 20px;
            background-color: rgba(107, 140, 188, 0.05);
        }
        
        .upload-area:hover {
            background-color: rgba(107, 140, 188, 0.1);
            border-color: var(--primary-color);
        }
        
        .upload-icon {
            font-size: 48px;
            color: var(--secondary-color);
            margin-bottom: 15px;
        }
        
        .upload-text {
            margin-bottom: 15px;
        }
        
        .btn {
            background-color: var(--primary-color);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 1rem;
            transition: var(--transition);
            display: inline-block;
        }
        
        .btn:hover {
            background-color: var(--secondary-color);
            transform: translateY(-2px);
        }
        
        .btn-accent {
            background-color: var(--accent-color);
        }
        
        .btn-accent:hover {
            background-color: #ff9a7a;
        }
        
        .btn-success {
            background-color: var(--success-color);
        }
        
        .btn-info {
            background-color: var(--info-color);
        }
        
        .preview-container {
            margin-top: 20px;
            text-align: center;
        }
        
        .preview-image {
            max-width: 100%;
            max-height: 300px;
            border-radius: 8px;
            box-shadow: var(--shadow);
            margin-bottom: 15px;
        }
        
        .note-form {
            margin-bottom: 30px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: var(--dark-color);
        }
        
        input, textarea, select {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 1rem;
            transition: var(--transition);
        }
        
        input:focus, textarea:focus, select:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 0 2px rgba(74, 111, 165, 0.2);
        }
        
        textarea {
            min-height: 150px;
            resize: vertical;
        }
        
        .notes-list {
            margin-top: 30px;
        }
        
        .note-card {
            background: var(--light-color);
            border-radius: 8px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-left: 4px solid var(--primary-color);
        }
        
        .note-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .note-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .note-title {
            font-size: 1.3rem;
            color: var(--primary-color);
        }
        
        .note-date {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .note-image {
            max-width: 100%;
            border-radius: 5px;
            margin-bottom: 15px;
            max-height: 200px;
            object-fit: cover;
        }
        
        .note-content {
            margin-bottom: 15px;
            line-height: 1.6;
        }
        
        .note-actions {
            display: flex;
            gap: 10px;
        }
        
        .btn-small {
            padding: 6px 12px;
            font-size: 0.9rem;
        }
        
        footer {
            text-align: center;
            padding: 20px;
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #6c757d;
        }
        
        .empty-icon {
            font-size: 64px;
            margin-bottom: 20px;
            opacity: 0.5;
        }
        
        .tag {
            display: inline-block;
            background-color: #e9ecef;
            color: #495057;
            padding: 4px 8px;
            border-radius: 20px;
            font-size: 0.8rem;
            margin-right: 5px;
            margin-bottom: 5px;
        }
        
        .tag-selector {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin-bottom: 15px;
        }
        
        .tag-option {
            cursor: pointer;
            padding: 5px 10px;
            border-radius: 15px;
            background-color: #e9ecef;
            transition: var(--transition);
        }
        
        .tag-option.active {
            background-color: var(--primary-color);
            color: white;
        }
        
        .user-list {
            margin-top: 20px;
        }
        
        .user-card {
            background: var(--light-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .user-name {
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .switch-user-btn {
            background-color: var(--secondary-color);
        }
        
        .current-user {
            background-color: rgba(74, 111, 165, 0.1);
            border-left: 4px solid var(--primary-color);
        }
        
        .social-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .social-card {
            background: var(--light-color);
            border-radius: 8px;
            padding: 20px;
            box-shadow: var(--shadow);
            transition: var(--transition);
        }
        
        .social-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .social-header {
            display: flex;
            align-items: center;
            margin-bottom: 15px;
        }
        
        .social-avatar {
            width: 50px;
            height: 50px;
            border-radius: 50%;
            background-color: var(--primary-color);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-weight: bold;
            margin-right: 15px;
        }
        
        .social-actions {
            display: flex;
            gap: 10px;
            margin-top: 15px;
        }
        
        .message-list {
            max-height: 300px;
            overflow-y: auto;
            margin-top: 20px;
            border: 1px solid #eee;
            border-radius: 8px;
            padding: 15px;
        }
        
        .message {
            padding: 10px;
            margin-bottom: 10px;
            border-radius: 8px;
            background-color: #f8f9fa;
        }
        
        .message.sent {
            background-color: rgba(74, 111, 165, 0.1);
            margin-left: 20px;
        }
        
        .message.received {
            background-color: #f0f0f0;
            margin-right: 20px;
        }
        
        .recommendation-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        
        .recommendation-card {
            background: var(--light-color);
            border-radius: 8px;
            padding: 15px;
            box-shadow: var(--shadow);
            transition: var(--transition);
            border-top: 4px solid var(--accent-color);
        }
        
        .recommendation-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.1);
        }
        
        .recommendation-title {
            font-weight: bold;
            margin-bottom: 10px;
            color: var(--primary-color);
        }
        
        .reminder-list {
            margin-top: 20px;
        }
        
        .reminder-item {
            background: var(--light-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .reminder-info {
            flex: 1;
        }
        
        .reminder-title {
            font-weight: bold;
            margin-bottom: 5px;
        }
        
        .reminder-time {
            color: #6c757d;
            font-size: 0.9rem;
        }
        
        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 15px 20px;
            background-color: var(--success-color);
            color: white;
            border-radius: 8px;
            box-shadow: var(--shadow);
            z-index: 1000;
            transform: translateX(150%);
            transition: transform 0.3s ease;
        }
        
        .notification.show {
            transform: translateX(0);
        }
        
        .collaboration-section {
            background: white;
            padding: 25px;
            border-radius: 10px;
            box-shadow: var(--shadow);
            margin-bottom: 20px;
        }
        
        .group-list {
            margin-top: 20px;
        }
        
        .group-card {
            background: var(--light-color);
            border-radius: 8px;
            padding: 15px;
            margin-bottom: 10px;
        }
        
        .group-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 10px;
        }
        
        .group-members {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            margin-top: 10px;
        }
        
        .member-tag {
            background-color: var(--secondary-color);
            color: white;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1>å¤šç”¨æˆ·å­¦ä¹ ç¬”è®°ç®¡ç†ç³»ç»Ÿ - å¢å¼ºç‰ˆ</h1>
            <p class="subtitle">ç¤¾äº¤äº’åŠ¨ | ä¸ªæ€§åŒ–æ¨è | æ•ˆç‡ä¼˜åŒ–</p>
        </header>
        
        <!-- æ ‡ç­¾å¯¼èˆª -->
        <div class="tab-navigation">
            <button class="tab-btn active" data-tab="notes">ç¬”è®°ç®¡ç†</button>
            <button class="tab-btn" data-tab="social">ç¤¾äº¤äº’åŠ¨</button>
            <button class="tab-btn" data-tab="recommendations">ä¸ªæ€§åŒ–æ¨è</button>
            <button class="tab-btn" data-tab="efficiency">æ•ˆç‡å·¥å…·</button>
        </div>
        
        <!-- ç¬”è®°ç®¡ç†æ ‡ç­¾é¡µ -->
        <div class="tab-content active" id="notes-tab">
            <!-- ç”¨æˆ·ç®¡ç†åŒºåŸŸ -->
            <section class="user-section">
                <h2 class="section-title">ç”¨æˆ·ç®¡ç†</h2>
                <div class="form-group">
                    <label for="userName">ç”¨æˆ·å</label>
                    <input type="text" id="userName" placeholder="è¯·è¾“å…¥æ‚¨çš„ç”¨æˆ·å">
                </div>
                <button class="btn" id="createUserBtn">åˆ›å»º/åˆ‡æ¢åˆ°ç”¨æˆ·</button>
                
                <div class="user-list" id="userList">
                    <!-- ç”¨æˆ·åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </section>
            
            <div class="main-content">
                <section class="upload-section">
                    <h2 class="section-title">ä¸Šä¼ å­¦ä¹ èµ„æ–™</h2>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-icon">ğŸ“·</div>
                        <p class="upload-text">ç‚¹å‡»æˆ–æ‹–æ‹½å›¾ç‰‡åˆ°æ­¤å¤„ä¸Šä¼ </p>
                        <p class="upload-hint">æ”¯æŒ JPG, PNG æ ¼å¼ï¼Œæœ€å¤§ 5MB</p>
                    </div>
                    <input type="file" id="fileInput" accept="image/*" style="display: none;">
                    
                    <div class="preview-container" id="previewContainer" style="display: none;">
                        <img id="previewImage" class="preview-image" src="" alt="é¢„è§ˆå›¾ç‰‡">
                        <button class="btn btn-accent" id="removeImageBtn">ç§»é™¤å›¾ç‰‡</button>
                    </div>
                    
                    <div class="tag-selector">
                        <div class="tag-option active" data-tag="å…¨éƒ¨">å…¨éƒ¨</div>
                        <div class="tag-option" data-tag="æ•°å­¦">æ•°å­¦</div>
                        <div class="tag-option" data-tag="ç¼–ç¨‹">ç¼–ç¨‹</div>
                        <div class="tag-option" data-tag="è‹±è¯­">è‹±è¯­</div>
                        <div class="tag-option" data-tag="ç‰©ç†">ç‰©ç†</div>
                        <div class="tag-option" data-tag="å…¶ä»–">å…¶ä»–</div>
                    </div>
                </section>
                
                <section class="notes-section">
                    <h2 class="section-title">æ·»åŠ å­¦ä¹ ç¬”è®°</h2>
                    <div class="note-form">
                        <div class="form-group">
                            <label for="noteTitle">ç¬”è®°æ ‡é¢˜</label>
                            <input type="text" id="noteTitle" placeholder="è¯·è¾“å…¥ç¬”è®°æ ‡é¢˜">
                        </div>
                        
                        <div class="form-group">
                            <label for="noteContent">ç¬”è®°å†…å®¹</label>
                            <textarea id="noteContent" placeholder="è¯·è¾“å…¥ç¬”è®°å†…å®¹..."></textarea>
                        </div>
                        
                        <div class="form-group">
                            <label for="noteTags">æ ‡ç­¾ï¼ˆç”¨é€—å·åˆ†éš”ï¼‰</label>
                            <input type="text" id="noteTags" placeholder="ä¾‹å¦‚ï¼šæ•°å­¦, å…¬å¼, é‡è¦">
                        </div>
                        
                        <button class="btn" id="saveNoteBtn">ä¿å­˜ç¬”è®°</button>
                    </div>
                    
                    <h2 class="section-title">æˆ‘çš„ç¬”è®°</h2>
                    <div class="notes-list" id="notesList">
                        <!-- ç¬”è®°å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                        <div class="empty-state">
                            <div class="empty-icon">ğŸ“</div>
                            <p>æš‚æ— ç¬”è®°ï¼Œè¯·æ·»åŠ æ‚¨çš„ç¬¬ä¸€æ¡å­¦ä¹ ç¬”è®°</p>
                        </div>
                    </div>
                </section>
            </div>
        </div>
        
        <!-- ç¤¾äº¤äº’åŠ¨æ ‡ç­¾é¡µ -->
        <div class="tab-content" id="social-tab">
            <section class="social-section">
                <h2 class="section-title">ç”¨æˆ·å…³æ³¨ä¸ç§ä¿¡</h2>
                <div class="social-grid" id="userGrid">
                    <!-- ç”¨æˆ·å¡ç‰‡å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
                
                <div class="message-section" style="margin-top: 30px;">
                    <h3 class="section-title">ç§ä¿¡</h3>
                    <div class="form-group">
                        <label for="messageRecipient">æ”¶ä»¶äºº</label>
                        <select id="messageRecipient">
                            <option value="">é€‰æ‹©ç”¨æˆ·</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="messageContent">æ¶ˆæ¯å†…å®¹</label>
                        <textarea id="messageContent" placeholder="è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹..."></textarea>
                    </div>
                    <button class="btn" id="sendMessageBtn">å‘é€æ¶ˆæ¯</button>
                    
                    <div class="message-list" id="messageList">
                        <!-- æ¶ˆæ¯åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </div>
                </div>
            </section>
            
            <section class="collaboration-section">
                <h2 class="section-title">å­¦ä¹ å°ç»„</h2>
                <div class="form-group">
                    <label for="groupName">å°ç»„åç§°</label>
                    <input type="text" id="groupName" placeholder="è¯·è¾“å…¥å°ç»„åç§°">
                </div>
                <div class="form-group">
                    <label for="groupMembers">å°ç»„æˆå‘˜ï¼ˆç”¨é€—å·åˆ†éš”ç”¨æˆ·åï¼‰</label>
                    <input type="text" id="groupMembers" placeholder="ä¾‹å¦‚ï¼šå¼ ä¸‰, æå››, ç‹äº”">
                </div>
                <button class="btn" id="createGroupBtn">åˆ›å»ºå­¦ä¹ å°ç»„</button>
                
                <div class="group-list" id="groupList">
                    <!-- å°ç»„åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </section>
        </div>
        
        <!-- ä¸ªæ€§åŒ–æ¨èæ ‡ç­¾é¡µ -->
        <div class="tab-content" id="recommendations-tab">
            <section class="recommendation-section">
                <h2 class="section-title">ä¸ºæ‚¨æ¨èçš„ç¬”è®°</h2>
                <div class="recommendation-grid" id="recommendationGrid">
                    <!-- æ¨èç¬”è®°å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </section>
            
            <section class="recommendation-section">
                <h2 class="section-title">å­¦ä¹ èµ„æ–™æ¨è</h2>
                <div class="recommendation-grid" id="resourceGrid">
                    <!-- æ¨èèµ„æ–™å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </section>
        </div>
        
        <!-- æ•ˆç‡å·¥å…·æ ‡ç­¾é¡µ -->
        <div class="tab-content" id="efficiency-tab">
            <section class="efficiency-section">
                <h2 class="section-title">ç¬”è®°å¯¼å‡º</h2>
                <div class="form-group">
                    <label for="exportFormat">å¯¼å‡ºæ ¼å¼</label>
                    <select id="exportFormat">
                        <option value="pdf">PDF</option>
                        <option value="word">Word</option>
                        <option value="html">HTML</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="exportNotes">é€‰æ‹©è¦å¯¼å‡ºçš„ç¬”è®°</label>
                    <select id="exportNotes" multiple>
                        <!-- ç¬”è®°é€‰é¡¹å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                    </select>
                </div>
                <button class="btn" id="exportBtn">å¯¼å‡ºç¬”è®°</button>
            </section>
            
            <section class="efficiency-section">
                <h2 class="section-title">å­¦ä¹ æé†’</h2>
                <div class="form-group">
                    <label for="reminderTitle">æé†’æ ‡é¢˜</label>
                    <input type="text" id="reminderTitle" placeholder="ä¾‹å¦‚ï¼šå¤ä¹ æ•°å­¦å…¬å¼">
                </div>
                <div class="form-group">
                    <label for="reminderTime">æé†’æ—¶é—´</label>
                    <input type="datetime-local" id="reminderTime">
                </div>
                <button class="btn" id="addReminderBtn">æ·»åŠ æé†’</button>
                
                <div class="reminder-list" id="reminderList">
                    <!-- æé†’åˆ—è¡¨å°†é€šè¿‡JavaScriptåŠ¨æ€æ·»åŠ  -->
                </div>
            </section>
        </div>
        
        <footer>
            <p>å¤šç”¨æˆ·å­¦ä¹ ç¬”è®°ç®¡ç†ç³»ç»Ÿ - å¢å¼ºç‰ˆ &copy; 2023 | å½“å‰ç”¨æˆ·: <span id="currentUserDisplay">æœªé€‰æ‹©</span></p>
        </footer>
    </div>

    <div class="notification" id="notification">
        æ“ä½œæˆåŠŸï¼
    </div>

    <script>
        // è·å–DOMå…ƒç´ 
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const previewContainer = document.getElementById('previewContainer');
        const previewImage = document.getElementById('previewImage');
        const removeImageBtn = document.getElementById('removeImageBtn');
        const saveNoteBtn = document.getElementById('saveNoteBtn');
        const noteTitle = document.getElementById('noteTitle');
        const noteContent = document.getElementById('noteContent');
        const noteTags = document.getElementById('noteTags');
        const notesList = document.getElementById('notesList');
        const tagOptions = document.querySelectorAll('.tag-option');
        const userNameInput = document.getElementById('userName');
        const createUserBtn = document.getElementById('createUserBtn');
        const userList = document.getElementById('userList');
        const currentUserDisplay = document.getElementById('currentUserDisplay');
        const tabBtns = document.querySelectorAll('.tab-btn');
        const tabContents = document.querySelectorAll('.tab-content');
        const userGrid = document.getElementById('userGrid');
        const messageRecipient = document.getElementById('messageRecipient');
        const messageContent = document.getElementById('messageContent');
        const sendMessageBtn = document.getElementById('sendMessageBtn');
        const messageList = document.getElementById('messageList');
        const groupName = document.getElementById('groupName');
        const groupMembers = document.getElementById('groupMembers');
        const createGroupBtn = document.getElementById('createGroupBtn');
        const groupList = document.getElementById('groupList');
        const recommendationGrid = document.getElementById('recommendationGrid');
        const resourceGrid = document.getElementById('resourceGrid');
        const exportFormat = document.getElementById('exportFormat');
        const exportNotes = document.getElementById('exportNotes');
        const exportBtn = document.getElementById('exportBtn');
        const reminderTitle = document.getElementById('reminderTitle');
        const reminderTime = document.getElementById('reminderTime');
        const addReminderBtn = document.getElementById('addReminderBtn');
        const reminderList = document.getElementById('reminderList');
        const notification = document.getElementById('notification');
        
        // å½“å‰ä¸Šä¼ çš„å›¾ç‰‡ï¼ˆBase64æ ¼å¼ï¼‰
        let currentImage = null;
        
        // ç”¨æˆ·ç›¸å…³å˜é‡
        let currentUser = localStorage.getItem('currentUser') || null;
        let users = JSON.parse(localStorage.getItem('noteUsers')) || {};
        
        // å½“å‰é€‰ä¸­çš„æ ‡ç­¾
        let currentTag = 'å…¨éƒ¨';
        
        // åˆå§‹åŒ–ç”¨æˆ·ç•Œé¢
        function initUserInterface() {
            if (currentUser) {
                currentUserDisplay.textContent = currentUser;
                renderNotes(); // æ˜¾ç¤ºå½“å‰ç”¨æˆ·çš„ç¬”è®°
            } else {
                currentUserDisplay.textContent = 'æœªé€‰æ‹©';
            }
            renderUserList();
            renderUserGrid();
            renderMessageRecipients();
            renderGroups();
            renderRecommendations();
            renderResources();
            renderExportNotes();
            renderReminders();
        }
        
        // æ ‡ç­¾é¡µåˆ‡æ¢
        tabBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                const tabId = btn.getAttribute('data-tab');
                
                // æ›´æ–°æ´»åŠ¨æ ‡ç­¾æŒ‰é’®
                tabBtns.forEach(b => b.classList.remove('active'));
                btn.classList.add('active');
                
                // æ›´æ–°æ´»åŠ¨æ ‡ç­¾å†…å®¹
                tabContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`${tabId}-tab`).classList.add('active');
            });
        });
        
        // ä¸Šä¼ åŒºåŸŸç‚¹å‡»äº‹ä»¶
        uploadArea.addEventListener('click', () => {
            fileInput.click();
        });
        
        // æ‹–æ”¾åŠŸèƒ½
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.style.backgroundColor = 'rgba(107, 140, 188, 0.15)';
        });
        
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.style.backgroundColor = 'rgba(107, 140, 188, 0.05)';
        });
        
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.style.backgroundColor = 'rgba(107, 140, 188, 0.05)';
            
            if (e.dataTransfer.files.length > 0) {
                const file = e.dataTransfer.files[0];
                if (file.type.startsWith('image/')) {
                    handleImageUpload(file);
                } else {
                    alert('è¯·ä¸Šä¼ å›¾ç‰‡æ–‡ä»¶ï¼');
                }
            }
        });
        
        // æ–‡ä»¶é€‰æ‹©äº‹ä»¶
        fileInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                const file = e.target.files[0];
                handleImageUpload(file);
            }
        });
        
        // å¤„ç†å›¾ç‰‡ä¸Šä¼ 
        function handleImageUpload(file) {
            if (file.size > 5 * 1024 * 1024) {
                alert('å›¾ç‰‡å¤§å°ä¸èƒ½è¶…è¿‡5MBï¼');
                return;
            }
            
            const reader = new FileReader();
            reader.onload = (e) => {
                currentImage = e.target.result;
                previewImage.src = currentImage;
                previewContainer.style.display = 'block';
            };
            reader.readAsDataURL(file);
        }
        
        // ç§»é™¤å›¾ç‰‡
        removeImageBtn.addEventListener('click', () => {
            currentImage = null;
            previewContainer.style.display = 'none';
            fileInput.value = '';
        });
        
        // æ ‡ç­¾é€‰æ‹©
        tagOptions.forEach(option => {
            option.addEventListener('click', () => {
                tagOptions.forEach(opt => opt.classList.remove('active'));
                option.classList.add('active');
                currentTag = option.getAttribute('data-tag');
                renderNotes();
            });
        });
        
        // åˆ›å»º/åˆ‡æ¢åˆ°ç”¨æˆ·
        createUserBtn.addEventListener('click', () => {
            const userName = userNameInput.value.trim();
            
            if (!userName) {
                alert('è¯·è¾“å…¥ç”¨æˆ·åï¼');
                return;
            }
            
            // å¦‚æœç”¨æˆ·ä¸å­˜åœ¨ï¼Œåˆ›å»ºæ–°ç”¨æˆ·
            if (!users[userName]) {
                users[userName] = {
                    createdAt: new Date().toISOString(),
                    notes: [],
                    following: [],
                    messages: [],
                    groups: [],
                    reminders: []
                };
                saveUsersToStorage();
            }
            
            // åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·
            switchToUser(userName);
            userNameInput.value = '';
        });
        
        // åˆ‡æ¢åˆ°æŒ‡å®šç”¨æˆ·
        function switchToUser(userName) {
            currentUser = userName;
            localStorage.setItem('currentUser', currentUser);
            currentUserDisplay.textContent = currentUser;
            renderUserList();
            renderUserGrid();
            renderNotes();
            renderMessageRecipients();
            renderMessages();
            renderGroups();
            renderRecommendations();
            renderResources();
            renderExportNotes();
            renderReminders();
        }
        
        // æ¸²æŸ“ç”¨æˆ·åˆ—è¡¨
        function renderUserList() {
            userList.innerHTML = '';
            
            Object.keys(users).forEach(userName => {
                const userCard = document.createElement('div');
                userCard.className = `user-card ${userName === currentUser ? 'current-user' : ''}`;
                
                userCard.innerHTML = `
                    <div>
                        <span class="user-name">${userName}</span>
                        <div>åˆ›å»ºäº: ${new Date(users[userName].createdAt).toLocaleDateString()}</div>
                        <div>ç¬”è®°æ•°é‡: ${users[userName].notes.length}</div>
                    </div>
                    <button class="btn btn-small switch-user-btn" data-user="${userName}">
                        ${userName === currentUser ? 'å½“å‰ç”¨æˆ·' : 'åˆ‡æ¢åˆ°è¯¥ç”¨æˆ·'}
                    </button>
                `;
                
                userList.appendChild(userCard);
            });
            
            // æ·»åŠ åˆ‡æ¢ç”¨æˆ·äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.switch-user-btn').forEach(btn => {
                if (!btn.textContent.includes('å½“å‰ç”¨æˆ·')) {
                    btn.addEventListener('click', (e) => {
                        const targetUser = e.target.getAttribute('data-user');
                        switchToUser(targetUser);
                    });
                }
            });
        }
        
        // æ¸²æŸ“ç”¨æˆ·ç½‘æ ¼ï¼ˆç”¨äºç¤¾äº¤äº’åŠ¨ï¼‰
        function renderUserGrid() {
            userGrid.innerHTML = '';
            
            Object.keys(users).forEach(userName => {
                if (userName === currentUser) return; // ä¸æ˜¾ç¤ºå½“å‰ç”¨æˆ·è‡ªå·±
                
                const userCard = document.createElement('div');
                userCard.className = 'social-card';
                
                const isFollowing = users[currentUser].following.includes(userName);
                
                userCard.innerHTML = `
                    <div class="social-header">
                        <div class="social-avatar">${userName.charAt(0)}</div>
                        <div>
                            <h3>${userName}</h3>
                            <p>${users[userName].notes.length} æ¡ç¬”è®°</p>
                        </div>
                    </div>
                    <div class="social-actions">
                        <button class="btn btn-small ${isFollowing ? 'btn-accent' : ''}" data-user="${userName}" id="followBtn-${userName}">
                            ${isFollowing ? 'å·²å…³æ³¨' : 'å…³æ³¨'}
                        </button>
                        <button class="btn btn-small btn-info" data-user="${userName}" id="messageBtn-${userName}">
                            å‘é€æ¶ˆæ¯
                        </button>
                    </div>
                `;
                
                userGrid.appendChild(userCard);
                
                // æ·»åŠ å…³æ³¨æŒ‰é’®äº‹ä»¶
                document.getElementById(`followBtn-${userName}`).addEventListener('click', (e) => {
                    const targetUser = e.target.getAttribute('data-user');
                    toggleFollow(targetUser);
                });
                
                // æ·»åŠ æ¶ˆæ¯æŒ‰é’®äº‹ä»¶
                document.getElementById(`messageBtn-${userName}`).addEventListener('click', (e) => {
                    const targetUser = e.target.getAttribute('data-user');
                    messageRecipient.value = targetUser;
                    // åˆ‡æ¢åˆ°ç¤¾äº¤æ ‡ç­¾é¡µ
                    document.querySelector('[data-tab="social"]').click();
                    // æ»šåŠ¨åˆ°æ¶ˆæ¯åŒºåŸŸ
                    document.getElementById('messageContent').focus();
                });
            });
        }
        
        // åˆ‡æ¢å…³æ³¨çŠ¶æ€
        function toggleFollow(targetUser) {
            const following = users[currentUser].following;
            const isFollowing = following.includes(targetUser);
            
            if (isFollowing) {
                users[currentUser].following = following.filter(user => user !== targetUser);
            } else {
                users[currentUser].following.push(targetUser);
            }
            
            saveUsersToStorage();
            renderUserGrid();
            showNotification(isFollowing ? `å·²å–æ¶ˆå…³æ³¨ ${targetUser}` : `å·²å…³æ³¨ ${targetUser}`);
        }
        
        // æ¸²æŸ“æ¶ˆæ¯æ”¶ä»¶äººé€‰é¡¹
        function renderMessageRecipients() {
            messageRecipient.innerHTML = '<option value="">é€‰æ‹©ç”¨æˆ·</option>';
            
            Object.keys(users).forEach(userName => {
                if (userName === currentUser) return;
                
                const option = document.createElement('option');
                option.value = userName;
                option.textContent = userName;
                messageRecipient.appendChild(option);
            });
        }
        
        // å‘é€æ¶ˆæ¯
        sendMessageBtn.addEventListener('click', () => {
            const recipient = messageRecipient.value;
            const content = messageContent.value.trim();
            
            if (!recipient) {
                alert('è¯·é€‰æ‹©æ”¶ä»¶äººï¼');
                return;
            }
            
            if (!content) {
                alert('è¯·è¾“å…¥æ¶ˆæ¯å†…å®¹ï¼');
                return;
            }
            
            const message = {
                id: Date.now(),
                from: currentUser,
                to: recipient,
                content: content,
                timestamp: new Date().toISOString(),
                read: false
            };
            
            // æ·»åŠ åˆ°å½“å‰ç”¨æˆ·çš„å‘é€æ¶ˆæ¯åˆ—è¡¨
            if (!users[currentUser].messages) {
                users[currentUser].messages = [];
            }
            users[currentUser].messages.push(message);
            
            // æ·»åŠ åˆ°æ”¶ä»¶äººçš„æ¥æ”¶æ¶ˆæ¯åˆ—è¡¨
            if (!users[recipient].messages) {
                users[recipient].messages = [];
            }
            users[recipient].messages.push({
                ...message,
                read: false
            });
            
            saveUsersToStorage();
            messageContent.value = '';
            renderMessages();
            showNotification('æ¶ˆæ¯å‘é€æˆåŠŸï¼');
        });
        
        // æ¸²æŸ“æ¶ˆæ¯åˆ—è¡¨
        function renderMessages() {
            messageList.innerHTML = '';
            
            if (!users[currentUser].messages || users[currentUser].messages.length === 0) {
                messageList.innerHTML = '<div class="empty-state">æš‚æ— æ¶ˆæ¯</div>';
                return;
            }
            
            // è¿‡æ»¤å‡ºä¸å½“å‰ç”¨æˆ·ç›¸å…³çš„æ¶ˆæ¯
            const userMessages = users[currentUser].messages.filter(msg => 
                msg.from === currentUser || msg.to === currentUser
            );
            
            // æŒ‰æ—¶é—´æ’åº
            userMessages.sort((a, b) => new Date(a.timestamp) - new Date(b.timestamp));
            
            userMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `message ${msg.from === currentUser ? 'sent' : 'received'}`;
                
                messageDiv.innerHTML = `
                    <div><strong>${msg.from === currentUser ? 'æˆ‘' : msg.from}</strong></div>
                    <div>${msg.content}</div>
                    <div style="font-size: 0.8rem; color: #6c757d; margin-top: 5px;">
                        ${new Date(msg.timestamp).toLocaleString()}
                    </div>
                `;
                
                messageList.appendChild(messageDiv);
            });
            
            // æ»šåŠ¨åˆ°åº•éƒ¨
            messageList.scrollTop = messageList.scrollHeight;
        }
        
        // åˆ›å»ºå­¦ä¹ å°ç»„
        createGroupBtn.addEventListener('click', () => {
            const name = groupName.value.trim();
            const membersInput = groupMembers.value.trim();
            
            if (!name) {
                alert('è¯·è¾“å…¥å°ç»„åç§°ï¼');
                return;
            }
            
            if (!membersInput) {
                alert('è¯·è¾“å…¥å°ç»„æˆå‘˜ï¼');
                return;
            }
            
            const members = membersInput.split(',').map(m => m.trim()).filter(m => m);
            
            // éªŒè¯æˆå‘˜æ˜¯å¦å­˜åœ¨
            const invalidMembers = members.filter(m => !users[m]);
            if (invalidMembers.length > 0) {
                alert(`ä»¥ä¸‹ç”¨æˆ·ä¸å­˜åœ¨: ${invalidMembers.join(', ')}`);
                return;
            }
            
            // æ·»åŠ å½“å‰ç”¨æˆ·åˆ°å°ç»„
            if (!members.includes(currentUser)) {
                members.push(currentUser);
            }
            
            const group = {
                id: Date.now(),
                name: name,
                creator: currentUser,
                members: members,
                createdAt: new Date().toISOString()
            };
            
            // ä¸ºæ¯ä¸ªæˆå‘˜æ·»åŠ å°ç»„ä¿¡æ¯
            members.forEach(member => {
                if (!users[member].groups) {
                    users[member].groups = [];
                }
                users[member].groups.push(group.id);
            });
            
            // ä¿å­˜å°ç»„ä¿¡æ¯
            let groups = JSON.parse(localStorage.getItem('noteGroups')) || {};
            groups[group.id] = group;
            localStorage.setItem('noteGroups', JSON.stringify(groups));
            
            saveUsersToStorage();
            groupName.value = '';
            groupMembers.value = '';
            renderGroups();
            showNotification('å­¦ä¹ å°ç»„åˆ›å»ºæˆåŠŸï¼');
        });
        
        // æ¸²æŸ“å­¦ä¹ å°ç»„
        function renderGroups() {
            groupList.innerHTML = '';
            
            const groups = JSON.parse(localStorage.getItem('noteGroups')) || {};
            const userGroups = users[currentUser]?.groups || [];
            
            if (userGroups.length === 0) {
                groupList.innerHTML = '<div class="empty-state">æ‚¨è¿˜æ²¡æœ‰åŠ å…¥ä»»ä½•å­¦ä¹ å°ç»„</div>';
                return;
            }
            
            userGroups.forEach(groupId => {
                const group = groups[groupId];
                if (!group) return;
                
                const groupCard = document.createElement('div');
                groupCard.className = 'group-card';
                
                groupCard.innerHTML = `
                    <div class="group-header">
                        <h3>${group.name}</h3>
                        <span>åˆ›å»ºè€…: ${group.creator}</span>
                    </div>
                    <p>åˆ›å»ºæ—¶é—´: ${new Date(group.createdAt).toLocaleDateString()}</p>
                    <div class="group-members">
                        ${group.members.map(member => `<span class="member-tag">${member}</span>`).join('')}
                    </div>
                `;
                
                groupList.appendChild(groupCard);
            });
        }
        
        // æ¸²æŸ“æ¨èç¬”è®°
        function renderRecommendations() {
            recommendationGrid.innerHTML = '';
            
            if (!currentUser) {
                recommendationGrid.innerHTML = '<div class="empty-state">è¯·å…ˆç™»å½•ä»¥æŸ¥çœ‹æ¨è</div>';
                return;
            }
            
            // è·å–å½“å‰ç”¨æˆ·çš„æ ‡ç­¾åå¥½
            const userTags = getUserTags();
            
            // æ”¶é›†æ‰€æœ‰ç”¨æˆ·çš„ç¬”è®°ï¼ˆæ’é™¤å½“å‰ç”¨æˆ·è‡ªå·±çš„ç¬”è®°ï¼‰
            let allNotes = [];
            Object.keys(users).forEach(userName => {
                if (userName !== currentUser) {
                    allNotes = allNotes.concat(users[userName].notes.map(note => ({
                        ...note,
                        author: userName
                    })));
                }
            });
            
            // æ ¹æ®æ ‡ç­¾åŒ¹é…åº¦æ’åº
            const recommendedNotes = allNotes
                .map(note => {
                    const score = calculateTagMatchScore(note.tags, userTags);
                    return { ...note, score };
                })
                .filter(note => note.score > 0)
                .sort((a, b) => b.score - a.score)
                .slice(0, 6); // åªæ˜¾ç¤ºå‰6ä¸ªæ¨è
            
            if (recommendedNotes.length === 0) {
                recommendationGrid.innerHTML = '<div class="empty-state">æš‚æ— æ¨èç¬”è®°</div>';
                return;
            }
            
            recommendedNotes.forEach(note => {
                const card = document.createElement('div');
                card.className = 'recommendation-card';
                
                const tagsHtml = note.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
                
                card.innerHTML = `
                    <div class="recommendation-title">${note.title}</div>
                    <div style="margin-bottom: 10px;">ä½œè€…: ${note.author}</div>
                    <div style="margin-bottom: 10px;">${note.content.substring(0, 100)}${note.content.length > 100 ? '...' : ''}</div>
                    <div>${tagsHtml}</div>
                `;
                
                recommendationGrid.appendChild(card);
            });
        }
        
        // æ¸²æŸ“å­¦ä¹ èµ„æ–™æ¨è
        function renderResources() {
            resourceGrid.innerHTML = '';
            
            if (!currentUser) {
                resourceGrid.innerHTML = '<div class="empty-state">è¯·å…ˆç™»å½•ä»¥æŸ¥çœ‹æ¨è</div>';
                return;
            }
            
            // è·å–å½“å‰ç”¨æˆ·çš„æ ‡ç­¾åå¥½
            const userTags = getUserTags();
            
            // æ¨¡æ‹Ÿå­¦ä¹ èµ„æ–™æ•°æ®
            const resources = [
                { title: 'æ•°å­¦å…¬å¼å¤§å…¨', type: 'PDF', tags: ['æ•°å­¦', 'å…¬å¼'], url: '#' },
                { title: 'Pythonç¼–ç¨‹å…¥é—¨', type: 'åœ¨çº¿è¯¾ç¨‹', tags: ['ç¼–ç¨‹', 'Python'], url: '#' },
                { title: 'è‹±è¯­è¯­æ³•ç²¾è®²', type: 'è§†é¢‘', tags: ['è‹±è¯­', 'è¯­æ³•'], url: '#' },
                { title: 'ç‰©ç†å®éªŒæ‰‹å†Œ', type: 'PDF', tags: ['ç‰©ç†', 'å®éªŒ'], url: '#' },
                { title: 'é«˜æ•ˆå­¦ä¹ æ³•', type: 'æ–‡ç« ', tags: ['å­¦ä¹ ', 'æ–¹æ³•'], url: '#' },
                { title: 'æ•°æ®ç»“æ„ä¸ç®—æ³•', type: 'åœ¨çº¿è¯¾ç¨‹', tags: ['ç¼–ç¨‹', 'ç®—æ³•'], url: '#' }
            ];
            
            // æ ¹æ®æ ‡ç­¾åŒ¹é…åº¦æ’åº
            const recommendedResources = resources
                .map(resource => {
                    const score = calculateTagMatchScore(resource.tags, userTags);
                    return { ...resource, score };
                })
                .filter(resource => resource.score > 0)
                .sort((a, b) => b.score - a.score)
                .slice(0, 6); // åªæ˜¾ç¤ºå‰6ä¸ªæ¨è
            
            if (recommendedResources.length === 0) {
                resourceGrid.innerHTML = '<div class="empty-state">æš‚æ— æ¨èèµ„æ–™</div>';
                return;
            }
            
            recommendedResources.forEach(resource => {
                const card = document.createElement('div');
                card.className = 'recommendation-card';
                
                const tagsHtml = resource.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
                
                card.innerHTML = `
                    <div class="recommendation-title">${resource.title}</div>
                    <div style="margin-bottom: 10px;">ç±»å‹: ${resource.type}</div>
                    <div>${tagsHtml}</div>
                    <button class="btn btn-small" style="margin-top: 10px;">æŸ¥çœ‹è¯¦æƒ…</button>
                `;
                
                resourceGrid.appendChild(card);
            });
        }
        
        // è·å–ç”¨æˆ·æ ‡ç­¾åå¥½
        function getUserTags() {
            const userNotes = users[currentUser].notes;
            const tagCount = {};
            
            userNotes.forEach(note => {
                note.tags.forEach(tag => {
                    tagCount[tag] = (tagCount[tag] || 0) + 1;
                });
            });
            
            return Object.keys(tagCount).sort((a, b) => tagCount[b] - tagCount[a]);
        }
        
        // è®¡ç®—æ ‡ç­¾åŒ¹é…åº¦
        function calculateTagMatchScore(tags1, tags2) {
            if (!tags1 || !tags2) return 0;
            
            const commonTags = tags1.filter(tag => tags2.includes(tag));
            return commonTags.length;
        }
        
        // æ¸²æŸ“å¯¼å‡ºç¬”è®°é€‰é¡¹
        function renderExportNotes() {
            exportNotes.innerHTML = '';
            
            if (!currentUser) {
                return;
            }
            
            const userNotes = users[currentUser].notes;
            
            userNotes.forEach(note => {
                const option = document.createElement('option');
                option.value = note.id;
                option.textContent = note.title;
                exportNotes.appendChild(option);
            });
        }
        
        // å¯¼å‡ºç¬”è®°
        exportBtn.addEventListener('click', () => {
            const format = exportFormat.value;
            const selectedOptions = Array.from(exportNotes.selectedOptions);
            const selectedNoteIds = selectedOptions.map(option => parseInt(option.value));
            
            if (selectedNoteIds.length === 0) {
                alert('è¯·é€‰æ‹©è¦å¯¼å‡ºçš„ç¬”è®°ï¼');
                return;
            }
            
            const userNotes = users[currentUser].notes;
            const selectedNotes = userNotes.filter(note => selectedNoteIds.includes(note.id));
            
            // æ¨¡æ‹Ÿå¯¼å‡ºè¿‡ç¨‹
            let exportContent = `# å­¦ä¹ ç¬”è®°å¯¼å‡º\n\n`;
            exportContent += `å¯¼å‡ºæ—¶é—´: ${new Date().toLocaleString()}\n`;
            exportContent += `å¯¼å‡ºæ ¼å¼: ${format.toUpperCase()}\n`;
            exportContent += `ç¬”è®°æ•°é‡: ${selectedNotes.length}\n\n`;
            
            selectedNotes.forEach((note, index) => {
                exportContent += `## ${index + 1}. ${note.title}\n\n`;
                exportContent += `åˆ›å»ºæ—¶é—´: ${note.date}\n\n`;
                exportContent += `æ ‡ç­¾: ${note.tags.join(', ')}\n\n`;
                exportContent += `${note.content}\n\n`;
                exportContent += `---\n\n`;
            });
            
            // åœ¨å®é™…åº”ç”¨ä¸­ï¼Œè¿™é‡Œä¼šæ ¹æ®æ ¼å¼ç”Ÿæˆç›¸åº”çš„æ–‡ä»¶
            // è¿™é‡Œåªæ˜¯æ¨¡æ‹Ÿå¯¼å‡ºè¿‡ç¨‹
            console.log(`å¯¼å‡ºå†…å®¹ (${format}):`, exportContent);
            showNotification(`ç¬”è®°å·²å¯¼å‡ºä¸º ${format.toUpperCase()} æ ¼å¼`);
        });
        
        // æ·»åŠ å­¦ä¹ æé†’
        addReminderBtn.addEventListener('click', () => {
            const title = reminderTitle.value.trim();
            const time = reminderTime.value;
            
            if (!title) {
                alert('è¯·è¾“å…¥æé†’æ ‡é¢˜ï¼');
                return;
            }
            
            if (!time) {
                alert('è¯·é€‰æ‹©æé†’æ—¶é—´ï¼');
                return;
            }
            
            const reminder = {
                id: Date.now(),
                title: title,
                time: time,
                createdAt: new Date().toISOString(),
                completed: false
            };
            
            if (!users[currentUser].reminders) {
                users[currentUser].reminders = [];
            }
            
            users[currentUser].reminders.push(reminder);
            saveUsersToStorage();
            
            reminderTitle.value = '';
            reminderTime.value = '';
            renderReminders();
            setupReminderNotification(reminder);
            showNotification('æé†’æ·»åŠ æˆåŠŸï¼');
        });
        
        // æ¸²æŸ“å­¦ä¹ æé†’
        function renderReminders() {
            reminderList.innerHTML = '';
            
            if (!currentUser || !users[currentUser].reminders || users[currentUser].reminders.length === 0) {
                reminderList.innerHTML = '<div class="empty-state">æš‚æ— å­¦ä¹ æé†’</div>';
                return;
            }
            
            const userReminders = users[currentUser].reminders;
            
            userReminders.forEach(reminder => {
                const reminderItem = document.createElement('div');
                reminderItem.className = 'reminder-item';
                
                const reminderTime = new Date(reminder.time);
                const now = new Date();
                const timeDiff = reminderTime - now;
                const hoursDiff = Math.floor(timeDiff / (1000 * 60 * 60));
                
                let statusText = '';
                if (reminder.completed) {
                    statusText = '<span style="color: var(--success-color);">å·²å®Œæˆ</span>';
                } else if (hoursDiff < 0) {
                    statusText = '<span style="color: var(--accent-color);">å·²è¿‡æœŸ</span>';
                } else if (hoursDiff < 24) {
                    statusText = `<span style="color: var(--warning-color);">å³å°†åˆ°æœŸ (${hoursDiff}å°æ—¶)</span>`;
                } else {
                    statusText = `<span style="color: var(--info-color);">${Math.floor(hoursDiff / 24)}å¤©ååˆ°æœŸ</span>`;
                }
                
                reminderItem.innerHTML = `
                    <div class="reminder-info">
                        <div class="reminder-title">${reminder.title}</div>
                        <div class="reminder-time">${reminderTime.toLocaleString()}</div>
                    </div>
                    <div>
                        ${statusText}
                        <button class="btn btn-small" data-id="${reminder.id}" style="margin-left: 10px;">${reminder.completed ? 'æ’¤é”€' : 'å®Œæˆ'}</button>
                    </div>
                `;
                
                reminderList.appendChild(reminderItem);
            });
            
            // æ·»åŠ å®Œæˆ/æ’¤é”€æŒ‰é’®äº‹ä»¶
            document.querySelectorAll('.reminder-item button').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.getAttribute('data-id'));
                    toggleReminderCompletion(id);
                });
            });
        }
        
        // åˆ‡æ¢æé†’å®ŒæˆçŠ¶æ€
        function toggleReminderCompletion(id) {
            const reminder = users[currentUser].reminders.find(r => r.id === id);
            if (reminder) {
                reminder.completed = !reminder.completed;
                saveUsersToStorage();
                renderReminders();
                showNotification(reminder.completed ? 'æé†’æ ‡è®°ä¸ºå·²å®Œæˆ' : 'æé†’å·²æ’¤é”€');
            }
        }
        
        // è®¾ç½®æé†’é€šçŸ¥
        function setupReminderNotification(reminder) {
            const reminderTime = new Date(reminder.time);
            const now = new Date();
            const timeDiff = reminderTime - now;
            
            if (timeDiff > 0) {
                setTimeout(() => {
                    if (Notification.permission === 'granted') {
                        new Notification('å­¦ä¹ æé†’', {
                            body: `è¯¥å¤ä¹ äº†: ${reminder.title}`,
                            icon: '/favicon.ico'
                        });
                    } else if (Notification.permission !== 'denied') {
                        Notification.requestPermission().then(permission => {
                            if (permission === 'granted') {
                                new Notification('å­¦ä¹ æé†’', {
                                    body: `è¯¥å¤ä¹ äº†: ${reminder.title}`,
                                    icon: '/favicon.ico'
                                });
                            }
                        });
                    }
                    
                    // åœ¨é¡µé¢ä¸Šä¹Ÿæ˜¾ç¤ºé€šçŸ¥
                    showNotification(`æé†’: ${reminder.title}`);
                }, timeDiff);
            }
        }
        
        // æ˜¾ç¤ºé€šçŸ¥
        function showNotification(message) {
            notification.textContent = message;
            notification.classList.add('show');
            
            setTimeout(() => {
                notification.classList.remove('show');
            }, 3000);
        }
        
        // ä¿å­˜ç”¨æˆ·æ•°æ®åˆ°æœ¬åœ°å­˜å‚¨
        function saveUsersToStorage() {
            localStorage.setItem('noteUsers', JSON.stringify(users));
        }
        
        // ä¿å­˜ç¬”è®°
        saveNoteBtn.addEventListener('click', () => {
            if (!currentUser) {
                alert('è¯·å…ˆé€‰æ‹©æˆ–åˆ›å»ºç”¨æˆ·ï¼');
                return;
            }
            
            const title = noteTitle.value.trim();
            const content = noteContent.value.trim();
            const tags = noteTags.value.split(',').map(tag => tag.trim()).filter(tag => tag);
            
            if (!title) {
                alert('è¯·è¾“å…¥ç¬”è®°æ ‡é¢˜ï¼');
                return;
            }
            
            if (!content) {
                alert('è¯·è¾“å…¥ç¬”è®°å†…å®¹ï¼');
                return;
            }
            
            const newNote = {
                id: Date.now(),
                title,
                content,
                tags,
                image: currentImage,
                date: new Date().toLocaleDateString('zh-CN')
            };
            
            users[currentUser].notes.unshift(newNote);
            saveUsersToStorage();
            renderNotes();
            renderExportNotes();
            renderRecommendations();
            
            // é‡ç½®è¡¨å•
            noteTitle.value = '';
            noteContent.value = '';
            noteTags.value = '';
            currentImage = null;
            previewContainer.style.display = 'none';
            fileInput.value = '';
            
            showNotification('ç¬”è®°ä¿å­˜æˆåŠŸï¼');
        });
        
        // æ¸²æŸ“ç¬”è®°åˆ—è¡¨
        function renderNotes() {
            notesList.innerHTML = '';
            
            if (!currentUser) {
                notesList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ‘¤</div>
                        <p>è¯·å…ˆé€‰æ‹©æˆ–åˆ›å»ºç”¨æˆ·</p>
                    </div>
                `;
                return;
            }
            
            let userNotes = users[currentUser].notes;
            
            // è¿‡æ»¤ç¬”è®°
            let filteredNotes = userNotes;
            if (currentTag !== 'å…¨éƒ¨') {
                filteredNotes = userNotes.filter(note => 
                    note.tags.includes(currentTag)
                );
            }
            
            if (filteredNotes.length === 0) {
                notesList.innerHTML = `
                    <div class="empty-state">
                        <div class="empty-icon">ğŸ“</div>
                        <p>æš‚æ— ç›¸å…³ç¬”è®°</p>
                    </div>
                `;
                return;
            }
            
            filteredNotes.forEach(note => {
                const noteCard = document.createElement('div');
                noteCard.className = 'note-card';
                
                const tagsHtml = note.tags.map(tag => `<span class="tag">${tag}</span>`).join('');
                
                noteCard.innerHTML = `
                    <div class="note-header">
                        <h3 class="note-title">${note.title}</h3>
                        <span class="note-date">${note.date}</span>
                    </div>
                    ${note.image ? `<img src="${note.image}" class="note-image" alt="ç¬”è®°å›¾ç‰‡">` : ''}
                    <div class="note-content">${note.content}</div>
                    <div class="note-tags">${tagsHtml}</div>
                    <div class="note-actions">
                        <button class="btn btn-small edit-btn" data-id="${note.id}">ç¼–è¾‘</button>
                        <button class="btn btn-small btn-accent delete-btn" data-id="${note.id}">åˆ é™¤</button>
                    </div>
                `;
                
                notesList.appendChild(noteCard);
            });
            
            // æ·»åŠ åˆ é™¤å’Œç¼–è¾‘äº‹ä»¶ç›‘å¬
            document.querySelectorAll('.delete-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.getAttribute('data-id'));
                    if (confirm('ç¡®å®šè¦åˆ é™¤è¿™æ¡ç¬”è®°å—ï¼Ÿ')) {
                        users[currentUser].notes = users[currentUser].notes.filter(note => note.id !== id);
                        saveUsersToStorage();
                        renderNotes();
                        renderExportNotes();
                        renderRecommendations();
                        showNotification('ç¬”è®°å·²åˆ é™¤');
                    }
                });
            });
            
            document.querySelectorAll('.edit-btn').forEach(btn => {
                btn.addEventListener('click', (e) => {
                    const id = parseInt(e.target.getAttribute('data-id'));
                    const note = users[currentUser].notes.find(note => note.id === id);
                    
                    if (note) {
                        noteTitle.value = note.title;
                        noteContent.value = note.content;
                        noteTags.value = note.tags.join(', ');
                        
                        if (note.image) {
                            currentImage = note.image;
                            previewImage.src = currentImage;
                            previewContainer.style.display = 'block';
                        }
                        
                        // åˆ é™¤åŸç¬”è®°
                        users[currentUser].notes = users[currentUser].notes.filter(n => n.id !== id);
                        saveUsersToStorage();
                        renderNotes();
                        renderExportNotes();
                        showNotification('ç¬”è®°å·²åŠ è½½åˆ°ç¼–è¾‘åŒºåŸŸ');
                    }
                });
            });
        }
        
        // åˆå§‹åŒ–é¡µé¢
        initUserInterface();
        
        // è¯·æ±‚é€šçŸ¥æƒé™
        if ('Notification' in window) {
            Notification.requestPermission();
        }
    </script>
</body>
</html>